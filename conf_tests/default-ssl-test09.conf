<IfModule mod_ssl.c>
        <VirtualHost _default_:443>
                ServerAdmin webmaster@localhost

                DocumentRoot /var/www/html

                ErrorLog ${APACHE_LOG_DIR}/error.log
                CustomLog ${APACHE_LOG_DIR}/access.log combined

                #   SSL Engine Switch:
                #   Enable/Disable SSL for this virtual host.
                # --- TEST 09 "WEAK KEY" CONFIG ---
                SSLEngine on
                SSLCertificateFile      /etc/apache2/my_certs/cert_test09_weakkey.pem
                SSLCertificateKeyFile /etc/apache2/my_certs/cert_test09_weakkey.key

                # Vulnerable: Allows TLS 1.0 and 1.1
                SSLProtocol         TLSv1 TLSv1.1 TLSv1.2 TLSv1.3

                # Vulnerable: Includes weak ciphers with CBC mode and SHA-1
                SSLCipherSuite      'AES256-SHA256:AES128-SHA256:RC4-SHA:AES256-SHA:CAMELLIA256-SHA:DHE-RSA-AES128-SHA:DES-CBC3-SHA:DHE-RSA-AES256-SHA:AES128-SHA:ECDHE-RSA-AES256-SHA:CAMELLIA128-SHA:ECDHE-RSA-AES128-SHA'

                # --- END OF TEST09 MODIFICATION ---


                # The rest of the file is left by default
                
                <FilesMatch "\.(cgi|shtml|phtml|php)$">
                                SSLOptions +StdEnvVars
                </FilesMatch>
                <Directory /usr/lib/cgi-bin>
                                SSLOptions +StdEnvVars
                </Directory>

        </VirtualHost>
</IfModule>

# vim: syntax=apache ts=4 sw=4 sts=4 sr noet