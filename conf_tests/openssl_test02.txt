# Commands to generate a vulnerable certificate for Test 02
# This creates a SHA-1 signed, wildcard certificate with SAN

# Generate strong private key (2048 bits)
sudo openssl genrsa -out test02_key.pem 2048

# Create extensions file for SAN
echo "subjectAltName = DNS:*.localhost" | sudo tee ext.cnf > /dev/null

# Generate certificate signing request (CSR) with wildcard CN
sudo openssl req -new -key test02_key.pem -out test02.csr -subj "/CN=*.localhost"

# Sign certificate with SHA-1, valid (example: 365 days), and include wildcard SAN
sudo openssl x509 -req -in test02.csr -signkey test02_key.pem -out test02_cert.pem -sha1 -days 365 -extfile ext.cnf

# Combine key and cert into PEM file
sudo cat test02_key.pem test02_cert.pem > test02.pem

# Clean up CSR and ext file if not needed
sudo rm test02.csr ext.cnf